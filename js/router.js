function updateMetaTags(e,t,i,a=null){document.title=e;const n=document.querySelector('meta[name="description"]');n&&n.setAttribute("content",t);let o=document.querySelector('link[rel="canonical"]');o||(o=document.createElement("link"),o.setAttribute("rel","canonical"),document.head.appendChild(o)),o.setAttribute("href",i);const r=document.querySelector('meta[property="og:title"]');r&&r.setAttribute("content",e);const c=document.querySelector('meta[property="og:description"]');c&&c.setAttribute("content",t);const l=document.querySelector('meta[property="og:url"]');if(l&&l.setAttribute("content",i),a){const e=document.querySelector('meta[property="og:image"]');e&&e.setAttribute("content",a)}const s=document.querySelector('meta[name="twitter:title"]');s&&s.setAttribute("content",e);const u=document.querySelector('meta[name="twitter:description"]');if(u&&u.setAttribute("content",t),a){const e=document.querySelector('meta[name="twitter:image"]');e&&e.setAttribute("content",a)}}function findItemById(e){let t=ARTICLES.find(t=>t.id===e);return t?[t,"article"]:(t=PUBLICATIONS.find(t=>t.id===e),t?[t,"publication"]:(t=FEATURED.find(t=>t.id===e),t?[t,"featured"]:[null,null]))}function loadRoute(){let e=window.location.pathname;e=e.replace(/\/index\.html$/,""),e=e.replace(/\/+$/,""),e||(e="/");const t=document.getElementById("main");if("/"===e||"/index.html"===e)return updateMetaTags("il Tafano — cronache, versi e riflessioni","Magazine culturale minimalista: articoli di cronaca, politica e società, pubblicazioni poetiche e filosofiche, contenuti in evidenza da tutto il mondo.","https://iltafano.it/"),void(t.innerHTML=createHomePage());if("/articoli"===e){updateMetaTags("Articoli — il Tafano",`Scopri ${ARTICLES.length} articoli su cronaca, politica, cultura, tecnologia, ambiente e altro ancora. Approfondimenti e analisi del presente.`,"https://iltafano.it/articoli"),t.innerHTML=createArticlesPage(),setupSearchFunctionality(ARTICLES,"/articoli",!1);const e=new URLSearchParams(window.location.search).get("topic");if(e){const t=document.getElementById("searchInput");if(t){t.value=e;const i=new Event("input",{bubbles:!0});t.dispatchEvent(i);document.querySelectorAll(".topic-chip").forEach(t=>{t.dataset.topic===e&&t.classList.add("active")})}}return}if(e.startsWith("/articoli/")){const i=e.split("/")[2],a=ARTICLES.find(e=>e.id===i);if(a){const e=a.images&&a.images.length>0?a.images[0].url:null;updateMetaTags(`${a.title} — il Tafano`,a.subtitle,`https://iltafano.it/articoli/${a.id}`,e),t.innerHTML=createDetailPage(a,!1,"/articoli")}else updateMetaTags("Pagina non trovata — il Tafano","La pagina che stai cercando non esiste.",window.location.href),t.innerHTML=create404Page();return}if("/pubblicazioni"===e)return updateMetaTags("Pubblicazioni — il Tafano",`Poesie, riflessioni filosofiche e versi sul margine del tempo. ${PUBLICATIONS.length} pubblicazioni da leggere con calma.`,"https://iltafano.it/pubblicazioni"),t.innerHTML=createPublicationsPage(),void setupSearchFunctionality(PUBLICATIONS,"/pubblicazioni",!0);if(e.startsWith("/pubblicazioni/")){const i=e.split("/")[2],a=PUBLICATIONS.find(e=>e.id===i);if(a){const e=a.images&&a.images.length>0?a.images[0].url:null;updateMetaTags(`${a.title} — il Tafano`,a.subtitle,`https://iltafano.it/pubblicazioni/${a.id}`,e),t.innerHTML=createDetailPage(a,!0,"/pubblicazioni")}else updateMetaTags("Pagina non trovata — il Tafano","La pagina che stai cercando non esiste.",window.location.href),t.innerHTML=create404Page();return}if("/in-evidenza"===e)return updateMetaTags("In Evidenza — il Tafano",`I contenuti più significativi selezionati dalla redazione. ${FEATURED.length} storie che meritano attenzione.`,"https://iltafano.it/in-evidenza"),t.innerHTML=createFeaturedPage(),void setupSearchFunctionality(FEATURED,"/in-evidenza",!1);if(e.startsWith("/in-evidenza/")){const i=e.split("/")[2],a=FEATURED.find(e=>e.id===i);if(a){const e=a.images&&a.images.length>0?a.images[0].url:null;updateMetaTags(`${a.title} — il Tafano`,a.subtitle,`https://iltafano.it/in-evidenza/${a.id}`,e),t.innerHTML=createDetailPage(a,!1,"/in-evidenza")}else updateMetaTags("Pagina non trovata — il Tafano","La pagina che stai cercando non esiste.",window.location.href),t.innerHTML=create404Page();return}if("/redazione"===e)return updateMetaTags("Redazione — il Tafano",`Scopri la redazione: ${REDAZIONE.length} giornalisti, scrittori, fotografi e creativi che danno vita al magazine.`,"https://iltafano.it/redazione"),void(t.innerHTML=createRedazionePage());if(e.startsWith("/redazione/")){const i=e.replace("/redazione/",""),a=REDAZIONE.find(e=>e.id===i);return void(a?(updateMetaTags(`${a.name} — il Tafano`,a.bio,`https://iltafano.it/redazione/${a.id}`,a.image),t.innerHTML=createRedattoreDetailPage(a)):(updateMetaTags("Pagina non trovata — il Tafano","La pagina che stai cercando non esiste.",window.location.href),t.innerHTML=create404Page()))}updateMetaTags("Pagina non trovata — il Tafano","La pagina che stai cercando non esiste.",window.location.href),t.innerHTML=create404Page()}function setupSearchFunctionality(e,t,i){const a=document.getElementById("searchInput"),n=document.getElementById("searchBtn"),o=document.getElementById("articlesList");if(!a||!o)return;const r=n.querySelector(".search-icon"),c=n.querySelector(".clear-icon");function l(){const n=a.value;o.innerHTML=createArticlesList(e,t,n,i),s()}function s(){a.value.length>0?(r.style.display="none",c.style.display="block",n.setAttribute("aria-label","Cancella ricerca")):(r.style.display="block",c.style.display="none",n.setAttribute("aria-label","Cerca"))}a.addEventListener("input",l),n.addEventListener("click",()=>{a.value&&(a.value="",l())}),s()}function navigateTo(e){history.pushState(null,null,e),loadRoute(),window.scrollTo(0,0)}function setupLinkInterception(){document.addEventListener("click",e=>{const t=e.target.closest("[data-link]");if(t){e.preventDefault();navigateTo(t.getAttribute("href"))}})}function setupBrowserBackButton(){window.addEventListener("popstate",loadRoute)}function initRouter(){setupLinkInterception(),setupBrowserBackButton(),loadRoute()}